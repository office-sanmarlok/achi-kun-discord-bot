#!/usr/bin/env python3
"""
UTF-8でファイルを書き込むヘルパースクリプト
Claude CodeのWriteツールのエンコーディング問題を回避するため
"""

import sys
import argparse

def write_utf8_file(filepath, content):
    """UTF-8エンコーディングでファイルを書き込む"""
    try:
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        print(f"✅ Successfully wrote {filepath} with UTF-8 encoding")
        return True
    except Exception as e:
        print(f"❌ Error writing file: {e}", file=sys.stderr)
        return False

def main():
    parser = argparse.ArgumentParser(description='Write UTF-8 encoded files')
    parser.add_argument('filepath', help='Path to the file to write')
    parser.add_argument('--stdin', action='store_true', help='Read content from stdin')
    parser.add_argument('--content', help='Content to write (if not using stdin)')
    
    args = parser.parse_args()
    
    if args.stdin:
        content = sys.stdin.read()
    elif args.content:
        content = args.content
    else:
        print("Error: Either --stdin or --content must be specified", file=sys.stderr)
        sys.exit(1)
    
    success = write_utf8_file(args.filepath, content)
    sys.exit(0 if success else 1)

if __name__ == '__main__':
    main()